# Socket.IO + Next.js + Supabase + OAuth

## â–¼ ãƒ†ãƒ¼ãƒ

1. Socket.IOã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’Next.jsã§æ§‹ç¯‰
1. ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’Supabaseã§ç®¡ç†
1. ã‚µã‚¤ãƒ³ã‚¤ãƒ³èªè¨¼ã‚’ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨Googleèªè¨¼
1. ç°¡å˜ãªRLSè¨­å®š

---

## â–¼ ãƒ‡ãƒ—ãƒ­ã‚¤

https://hitorigods-socket-io-next.onrender.com/

---

## â–¼ ERå›³

ã€æœªåæ˜ ã€‘Supabaseã®ã‚­ãƒ£ãƒ—ãƒãƒ£è²¼ã‚‹

---

## â–¼ é–‹ç™ºãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰‹é †

ã€æœªåæ˜ ã€‘å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰èª¬æ˜

ã€æœªåæ˜ ã€‘.env.localèª¬æ˜

ã€æœªåæ˜ ã€‘Supabase CLIèª¬æ˜

---

## â–¼ TODO

â­•ï¼šå®Œäº†ã€âš ï¼šå®Ÿè£…ã—ãŸãŒæ€ã†ã¨ã“ã‚ã‚Šã€âï¼šä½™è£•ãŒã§ãŸã‚‰å®Ÿè£…ã™ã‚‹ã‹ã‚‚ï¼Ÿ

1. é–‹ç™ºç’°å¢ƒ
   1. â­•create-next-app
   2. â­•Jotaiã«Devtoolsã‚’å°å…¥
   3. â­•TanStack Queryå®Ÿè£…
   4. âš ORMï¼ˆprismaï¼‰å°å…¥ â‡’ çµå±€æ´»ç”¨ã§ãã¦ãªã„ï¼Ÿ
      1. âš seedãƒ‡ãƒ¼ã‚¿ç™»éŒ² â‡’ SQLå£Šã‚Œã‚‹ï¼Ÿ
   5. â­•Supabaseå°å…¥
      1. â­•ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°ã•ã‚ŒãŸã‚‰updateAtã‚’æ›´æ–°ã™ã‚‹ï¼ˆSQLï¼‰
      2. âãƒªãƒ¢ãƒ¼ãƒˆsupabase ã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤
      3. âsupabase CLIã§seedãƒ‡ãƒ¼ã‚¿ä½œã‚‹ï¼ˆSnapletï¼‰
2. ãƒ‡ãƒ—ãƒ­ã‚¤
   1. â­•Renderã«ãƒ‡ãƒ—ãƒ­ã‚¤
   2. âã‚µãƒ¼ãƒãƒ¼ç›£è¦–ã‚µãƒ¼ãƒ“ã‚¹ã§Rendar/Supabaseã‚’è½ã¡ãªãã™ã‚‹
3. ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ
   1. â­•atomã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†é›¢
4. Socketæ©Ÿèƒ½
   1. â­•Socketéƒ¨åˆ†ã®ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰
   2. â­•Socketéƒ¨åˆ†ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰
   3. â­•ãƒ«ãƒ¼ãƒ ã‹ã‚‰å‡ºãŸã‚‰ã«ã‚½ã‚±ãƒƒãƒˆã‚’åˆ‡æ–­ã™ã‚‹
   4. Socketæ©Ÿèƒ½ã‚’ä¸€ã¤ã«ã¾ã¨ã‚ã¦åˆ†é›¢
5. ã‚µã‚¤ãƒ³ã‚¤ãƒ³æ©Ÿèƒ½
   1. â­•ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆ
   2. â­•ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™»éŒ²
   3. â­•ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆå‡¦ç†
   4. â­•ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¤å®šã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   5. â­•ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹èªè¨¼
   6. OAuthå®Ÿè£…
      1. â­•Google
      2. â­•GitHub
      3. â­•Discord
   7. ã‚¨ãƒ©ãƒ¼ã®ã‚¢ãƒ©ãƒ¼ãƒˆå†…å®¹ã‚’æ—¥æœ¬èªã«
6. ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½
   1. â­•ãƒ†ãƒ¼ãƒ–ãƒ«ç”¨æ„
   2. â­•ãƒãƒ£ãƒƒãƒˆã®ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½
   3. â­•æ‰€æœ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãƒãƒ£ãƒƒãƒˆå‰Šé™¤ãƒ»æ›´æ–°
   4. â­•ãƒ«ãƒ¼ãƒ å…¥å®¤ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã‚¯ã‚¨ãƒªä¿æŒã—ã¦ãƒãƒ£ãƒƒãƒˆå¾©å…ƒ
   5. â­•ã‚½ã‚±ãƒƒãƒˆå—ä¿¡ã§ã‚¯ã‚¨ãƒªæ›´æ–°
   6. ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
   7. RLSè¨­å®šï¼ˆé–²è¦§ã¯å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ç·¨é›†å‰Šé™¤ã¯æ‰€æœ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
   8. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆZodï¼‰
   9. âå—ä¿¡ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã®ã‚»ãƒ¬ã‚¯ãƒˆæ–¹æ³•ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã§å‡¦ç†ï¼ˆSupabaseã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ï¼Ÿï¼‰
   10. âãƒãƒ£ãƒƒãƒˆã®éå…¬é–‹è¨­å®š
   11. âãƒãƒ£ãƒƒãƒˆãŒæ›´æ–°ã•ã‚ŒãŸã‚‰éŸ³é³´ã‚‰ã™
   12. âä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚µã‚¤ãƒ³ã‚¤ãƒ³é€šçŸ¥ã€å…¥é€€å®¤ãŒç›®ã«è¦‹ãˆã‚‹ã‚ˆã†ã«
7. ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ©Ÿèƒ½
   1. â­•ãƒ†ãƒ¼ãƒ–ãƒ«ç”¨æ„
   2. â­•åˆå›ã«ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’ç™»éŒ²
   3. â­•ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’ç·¨é›†
   4. â­•ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
   5. â­•ç”»åƒã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç™»éŒ²
   6. â­•ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã‚’å–å¾—
   7. â­•ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸå ´åˆã¯ç™»éŒ²æ¸ˆã¿ã®ç”»åƒã‚’è¡¨ç¤º
   8. â­•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç™»éŒ²ã—ãŸã‚‰å‰å›ã®ç”»åƒã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å‰Šé™¤
   9. RLSè¨­å®šï¼ˆé–²è¦§ã¯å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ç·¨é›†å‰Šé™¤ã¯æ‰€æœ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
   10. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆZodï¼‰
8. ãƒ«ãƒ¼ãƒ æ©Ÿèƒ½
   1. â­•ãƒ†ãƒ¼ãƒ–ãƒ«ç”¨æ„
   2. ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ‡ãƒªãƒ¼ãƒˆè¨­å®š
   3. ãƒ«ãƒ¼ãƒ ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«Socketæ¥ç¶šã—ã¦ç›´ãƒªãƒ³ã‚¯å¯èƒ½ã«
   4. ãƒ«ãƒ¼ãƒ ã®ä½œæˆ
   5. ãƒ«ãƒ¼ãƒ IDã«ä¸€è‡´ã—ãŸãƒãƒ£ãƒƒãƒˆãƒªã‚¹ãƒˆã‚’å–å¾—
   6. ãƒ«ãƒ¼ãƒ ã®ä¸€è¦§è¡¨ç¤ºã¨å€‹åˆ¥ãƒšãƒ¼ã‚¸ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
   7. ãƒ«ãƒ¼ãƒ ä½œæˆã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãƒ«ãƒ¼ãƒ åç·¨é›†
   8. RLSè¨­å®šï¼ˆé–²è¦§ã¯å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ç·¨é›†å‰Šé™¤ã¯æ‰€æœ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
   9. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆZodï¼‰
9. ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆèª¿æ•´
   1. â­•ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆTOP/ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«/ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ/ãƒãƒ£ãƒƒãƒˆä¸€è¦§ï¼‰
   2. â­•ãƒãƒ£ãƒƒãƒˆä¸€è¦§ç”»é¢
   3. â­•ãƒãƒ£ãƒƒãƒˆä½œæˆã•ã‚ŒãŸã‚‰æœ€æ–°ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç§»å‹•
   4. â­•ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ç”»é¢
      1. ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³éƒ¨åˆ†
   5. â­•ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ç”»é¢
   6. TOPã®ãƒ«ãƒ¼ãƒ ä¸€è¦§
   7. ãƒ•ã‚§ãƒƒãƒãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã®ã‚¹ãƒ”ãƒŠãƒ¼è¡¨ç¤º
   8. â­•ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¿ãƒ–ã§ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã®å¯è¦–åŒ–ï¼ˆã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ï¼‰
   9. æŠ•ç¨¿ãŒè‡ªåˆ†ã‹ä»–äººã‹åˆ¤å®šã—ã¦ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå¤‰ãˆã‚‹
   10. ç·¨é›†ãƒ»å‰Šé™¤ã™ã‚‹ã¨ãã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ã‚„ã‚ã¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€šçŸ¥è¡¨ç¤ºï¼ˆã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã¨åˆã‚ã›ã¦ï¼‰
   11. ãƒãƒ£ãƒƒãƒˆã®å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ãŒæœ€åˆã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚ˆã†ã«
   12. ã‚¨ãƒ©ãƒ¼ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ã‚„ã‚ã¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€šçŸ¥è¡¨ç¤ºï¼ˆã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã¨åˆã‚ã›ã¦ï¼‰
10. README
    1. é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ•ã‚©ãƒ«ãƒ€ã«ã¾ã¨ã‚ã‚‹
    2. ERå›³ã®ã‚­ãƒ£ãƒ—ãƒãƒ£ç”»åƒã‚’è²¼ã‚‹
    3. âå‚è€ƒURLã‚’ã‚¿ãƒ–åˆ†ã‘
11. ğŸ’€ğŸ’€ğŸ’€ **BugFix** ğŸ’€ğŸ’€ğŸ’€
    1. Supabaseã®ã‚¹ã‚­ãƒ¼ãƒSQLã‚’CIã‹ã‚‰å¾©å…ƒã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼
    2. ãƒªãƒ¢ãƒ¼ãƒˆSupabaseã«Push/Pullã§ã‚¨ãƒ©ãƒ¼

---

## â–¼ é›‘æ„Ÿ

- ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã®åˆå›ã‚¢ã‚¯ã‚»ã‚¹ã®ã¿DBã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—ã—ã¦Jotaiã§ã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç†ã€ãƒšãƒ¼ã‚¸ã«ã„ã‚‹é–“ã¯ã™ã¹ã¦ã‚¹ãƒ†ãƒ¼ãƒˆæ›´æ–°ã ã‘ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«æ›´æ–°ã•ã›ãŸ
  - DBæ›´æ–°ã¨ä¸€ç·’ã«ã‚¹ãƒ†ãƒ¼ãƒˆæ›´æ–°ã ã‘ã§ãªãã‚½ã‚±ãƒƒãƒˆã«æ›´æ–°å†…å®¹ã‚’å—ä¿¡ã—ã¦å†åº¦ã‚¹ãƒ†ãƒ¼ãƒˆæ›´æ–°ã•ã›ã¦ã‚‹
  - WebSocketã‚’ä½¿ã‚ãªãã¦ã‚‚Supabaseã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ã‚„reactQueryã®`useQuery`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å®šæœŸãƒ•ã‚§ãƒƒãƒã•ã›ã‚‹`refetchInterval`ã ã‘ã§ã‚‚æ™®é€šã«ä½œã‚Œãã†ã ã£ãŸ
    - ãŒã€Supabaseã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆã§é–‹ç™ºã—ã¦ã„ãŸãŒ3æ—¥ç›®ã§ç„¡æ–™æ åˆ¶é™ã«åˆ°é”â€¦ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã§é–‹ç™ºå¿…é ˆ
    - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é€šä¿¡ã‚³ã‚¹ãƒˆè€ƒãˆã‚‹ã¨æ›´æ–°ã®åº¦ã«ãƒ•ã‚§ãƒƒãƒã•ã›ã‚‹ã®ã¯å¾®å¦™
    - `refetchInterval`ã‚’ã‚„ã‚ã¦ã•ã›ã¦ã‚½ã‚±ãƒƒãƒˆå—ä¿¡ã—ãŸã¨ãã®ã¿getQueryã‚’å©ã„ãã‚ˆã†ã«ã—ã¦ã¿ãŸãŒã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°çµæœãŒä¸€å›åˆ†ãšã‚ŒãŸã®ã§çµå±€ã‚¹ãƒ†ãƒ¼ãƒˆã§ç®¡ç†ã«ã—ãŸâ€¦
      - `useQuery`ã®å†ãƒ•ã‚§ãƒƒãƒãŒ`run dev`çŠ¶æ…‹ã¨`run build&&start`ã§æŒ™å‹•ãŒé•ã†ã®ã¯ãªãœï¼Ÿ`useEffect`ãŒäºŒå›å®Ÿè¡Œã•ã‚Œã‚‹ã‹ã‚‰ï¼Ÿ
    - ã‚µã‚¤ãƒ³ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã‹æ´»å‹•ä¸­ã®ãƒ«ãƒ¼ãƒ ã¨ã‹ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ¤å®šã¨ã‹ã™ã‚‹ãªã‚‰WebSocketã®æ–¹ãŒã„ã„ï¼Ÿ
- ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§çµã‚Šæ··ã‚“ã§ã„ã‚‹ãŒæœ¬æ¥ã¯ã‚µãƒ¼ãƒãƒ¼ã§å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã™ã¹ãï¼ˆSupabaseã®`rpc`ã‚«ã‚¹ã‚¿ãƒ ã‚¯ã‚¨ãƒªï¼Ÿï¼‰
- ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã‚„ãƒ•ã‚¡ã‚¤ãƒ«å/é–¢æ•°ã®å‘½åè¦å‰‡ã¯ãšã£ã¨æ‰‹æ¢ã‚Šã ã£ãŸâ€¦
  - æœ€åˆã¯`util/hooks/libs/stores/shemas`ãªã©ç´°ã‹ãåˆ†ã‘ã¦ã„ãŸãŒã€ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³çš„ã«æ©Ÿèƒ½ä¾å­˜ã‚’å…ƒã«`future`ãƒ•ã‚©ãƒ«ãƒ€ã«ã”ãã£ã¨ã¾ã¨ã‚ãŸ
  - ã˜ã‚ƒã‚ã€`components`ãƒ•ã‚©ãƒ«ãƒ€ã£ã¦ãªã‚“ãªã®ã•â€¦ã€‚`utils`ãƒ•ã‚©ãƒ«ãƒ€ã‚‚åŸºæº–ãŒæ›–æ˜§â€¦ã€‚
    - ã¨ã‚Šã‚ãˆãšãƒœã‚¿ãƒ³ã¨ã‹æ±ç”¨ãƒ‘ãƒ¼ãƒ„ã¨ã‹ã‚’`components`ã€ä¾¿åˆ©é–¢æ•°ã‚’`hooks`ã€å…¨ä½“ã‚’æ¨ªæ–­ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªé–¢ä¿‚ã‚’`libs`ã¨ã—ã¦`utils`ã«ã¶ã£è¾¼ã‚“ã ãŒãƒ¢ãƒ¤ãƒƒã¨ã¯ã—ã¦ã‚‹
  - ã›ã£ã‹ãAppRouterãªã®ã§ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã§ã‚‚ã‚ˆã‹ã£ãŸã‹ã‚‚ï¼Ÿ
  - WebSocketã®APIãƒ«ãƒ¼ãƒˆãŒPageRouterã§ãªã„ã¨æ©Ÿèƒ½ã—ãªã„ã£ã½ã„ï¼ˆè¦èª¿æŸ»ï¼‰ã®ã§`pages`ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½¿ã£ã¦ã„ã‚‹ãŒé‚ªé­”â€¦
- æ¬¡å›Next.jsã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½¿ã†ãªã‚‰T3ã‚¹ã‚¿ãƒƒã‚¯ã§å§‹ã‚ãŸã„
  - Prismaã‚’ã†ã¾ãæ´»ç”¨ã§ãã¦ãªã„ã®ã¨tRPCã‚‚è©¦ã—ãŸã„

---

## â–¼ å‚™å¿˜éŒ²

### â–  supabase CLIã§ãƒ‡ãƒ¼ã‚¿æ“ä½œ

Push/Pull

```
$ supabase db push
$ supabase db pull
```

ãƒ­ãƒ¼ã‚«ãƒ«ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°è¦ä½œæˆ

```
$ supabase migration new [ãƒ•ã‚¡ã‚¤ãƒ«å]
```

ä½œæˆã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚µãƒ¼ãƒãƒ¼ã®å·®åˆ†ã‚’å–å¾—

```
$ supabase db diff --linked > supabase\migrations\[ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—]_[ãƒ•ã‚¡ã‚¤ãƒ«å].sql
```

ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åæ˜ 

```
$ supabase db reset
```

ãƒªãƒ¢ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã®seedã«æ®‹ã™

```
$ supabase db dump -f supabase/seed.sql --data-only
```

https://qiita.com/masakinihirota/items/b84c071415eeebb4a252

### â–  supabase CLIã§å‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ

npm scriptsã‚’ã§å©ãã‚ˆã†ã«ã—ãŸã„ãŒã€Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã‚’gitã«æ®‹ã—ãŸããªã„ã®ã§ã€ `.env.local`ã®ç’°å¢ƒå¤‰æ•°`DATABASE_URL`ã‚’ç”¨æ„ã—ã¦ã€`tsx`ã§ `supabase-types.ts`ã‚’å®Ÿè¡Œ

```
$ pnpm run supabase:types

â†“å®Ÿè¡Œ
$ dotenv -e .env.local -- tsx supabase-types.ts

â†“å†…éƒ¨å‡¦ç†
$ supabase gen types typescript --db-url ${process.env.DATABASE_URL} > src/libs/supabase.types.ts
```

https://hassakulab.com/posts/npm-script-with-dotenv/

â€»ts-nodeã ã¨CommonJSãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ‰±ã„ã«ãªã‚Šã‚¨ãƒ©ãƒ¼ãŒã§ãŸã®ã§tsxã‚’åˆ©ç”¨

â€»ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã§ã¯DB URLã®æŒ‡å®šã§å–å¾—ã§ããŸã®ã§ã€ä»¥å‰ã®ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆå‰æã ã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDæŒ‡å®šã¯ã‚„ã‚ãŸ

ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆGUIãªã‚‰ä»¥ä¸‹ã‹ã‚‰ä½œæˆã§ãã‚‹

https://supabase.com/dashboard/project/zmjeowldxauntodensjj/api?page=tables-intro

### â–  Supabase ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã§OAuthã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆãŒlocalhostã§ã¯ãªã127.0.0.1ã«ãªã£ã¦ã—ã¾ã†å•é¡Œ

`/supabase/config.toml`ã®site_urlã‚’localhostã«ã™ã‚‹

```diff
-site_url = "http://127.0.0.1:3000"
+site_url = "http://localhost:3000"
```

### â–  Prisma Migrateã‚’dotenvã‚’ä½¿ã„.env.localã§å®Ÿè¡Œ

```
PNPM
$ ./node_modules/.bin/dotenv -e .env.local -- pnpm dlx prisma migrate dev --name init
```

### â–  prisma/seed.tsã§ts-nodeãŒã‚¨ãƒ©ãƒ¼ã«ãªã‚‹å•é¡Œ

#### â‘  tsx ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
$ pnpm i -D tsx
```

https://github.com/privatenumber/tsx

â€»PATHã‚’é€šã™ãŸã‚ä¸€åº¦ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ã—ãŸ

#### â‘¡ package.jsonã«è¿½è¨˜

```
"prisma": {
  "seed": "tsx prisma/seed.ts"
},
```

ä»¥ä¸‹ã¯è§£æ±ºã§ããš

```
"prisma": {
  "seed": "ts-node --compiler-options {\"module\":\"CommonJS\"} prisma/seed.ts"
},
```

https://github.com/prisma/prisma/issues/7053

### â–  ã€ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆï¼Ÿã€‘Prismaã§seedãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã¨Supabaseã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒãŠã‹ã—ããªã‚‹ã“ã¨ãŒå¤šç™º

ä»Šã®ã¨ã“ã‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œã‚Šç›´ã™ã—ã‹ã©ã†ã—ã‚ˆã†ã‚‚ãªã„ã®ã§ã€GUIã‹ã‚‰CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§å‡Œãâ€¦

â€»ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã§ã¯ã¾ã è©¦ã—ã¦ãªã„ãŒSupabase CLIã§ãƒ—ãƒƒã‚·ãƒ¥ã§ããã†

https://github.com/supabase/supabase/issues/4883

â†“ã“ã®è¾ºã‹ã‚‚ï¼Ÿ

https://supabase.com/docs/guides/cli/managing-environments

---

## â–¼ ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ

### â–  Zod

https://zenn.dev/uttk/articles/bd264fa884e026

### â–  Tailwind CSS

https://tailwindcomponents.com/cheatsheet/

https://tailwindcomponents.com/

https://zenn.dev/ixkaito/articles/advanced-tailwindcss

### â–  prisma ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ (CLI)

https://qiita.com/ryskBonn92/items/c45e22ce5f37d82ec8de

### â–  Prismaãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ä¸€è¦§

https://qiita.com/curry__30/items/95d3655fa23d84b959a3

## â–¼ å…¬å¼

### â–  Supabase CLI

https://supabase.com/docs/guides/cli/getting-started?platform=windows

### â–  Snaplet

https://docs.snaplet.dev/recipes/supabase

### â–  React Query

https://tanstack.com/query/v4/docs/react/installation

### â–  Socket.io

https://socket.io/docs/v4/

#### â—‹ Uptime Robotï¼ˆã‚µãƒ¼ãƒãƒ¼ç›£è¦–ã‚µãƒ¼ãƒ“ã‚¹ï¼‰

https://uptimerobot.com/

https://laboradian.com/uptime-robot/

## â–¼ å‚è€ƒ

### â–  Socketç³»

#### â—‹ Next.js ã§ WebSocket ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹

https://qiita.com/ochiochi/items/dbf5040fd665326e8fb5

https://qiita.com/ochiochi/items/102d14649396d351ab80

#### â—‹ Socket.IOã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚“ã§åŸºæœ¬ã‚’å‹‰å¼·ã—ã¦ã¿ãŸ

https://qiita.com/okumurakengo/items/92ad5aacd08c4e25ebeb

#### â—‹ React Queryã¨çµ„ã¿åˆã‚ã›ã‚‹

https://tkdodo.eu/blog/using-web-sockets-with-react-query

### â–  DBç³»

#### â—‹ Supabaseå…¥é–€

https://zenn.dev/chot/articles/ddd2844ad3ae61

https://zenn.dev/yu_undefined/scraps/ee259f6dd080a5

#### â—‹ Supabase Tips ã‚µãƒ¼ãƒãƒ¼ã®ã‚¹ã‚­ãƒ¼ãƒã¨ãã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã®Supabaseã«åæ˜ ã•ã›ã‚‹ã€‚

https://qiita.com/masakinihirota/items/e8e83cb10b56047d4bae

#### â—‹ Supabase + useQuery

https://makerkit.dev/blog/saas/supabase-react-query

#### â—‹ Supabase ã® DB ã§è¡ŒãŒæ›´æ–°ã•ã‚ŒãŸã‚‰ updated_at ã‚‚åŒæ™‚ã«æ›´æ–°ã™ã‚‹

https://zenn.dev/panda_program/scraps/b97575650ef08c

#### â—‹ uuidã®æ˜¯é

https://techblog.raccoon.ne.jp/archives/1627262796.html

#### â—‹ supabaseã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

https://katblog.manadream.net/index.php/2022/07/07/supabase-local/

#### â—‹ Supabaseã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã€è¡¨ç¤ºã™ã‚‹

https://qiita.com/dshukertjr/items/05437bb88bc7ae8583b8

### â–  OAuthç³»

#### â—‹ Next.js + Supabase ã‚¢ãƒ—ãƒªã§ã‚µãƒ¼ãƒãƒ¼ã‚„ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã§ã€èªè¨¼ã«å¿…è¦ãª Client ID ã¨ Client secrets ã®å–å¾—ã€‚(Slackã€Googleã€GitHub)

https://qiita.com/masakinihirota/items/706326a64dab3ffbf55b

#### â—‹ supabaseã®èªè¨¼æ©Ÿèƒ½

https://qiita.com/kaho_eng/items/cb8d735b5b6ca1b3a6c5

#### â—‹ OAuth & OIDC å…¥é–€è§£èª¬

https://www.youtube.com/watch?v=PKPj_MmLq5E
